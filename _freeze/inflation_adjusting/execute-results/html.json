{
  "hash": "672b8702d2405eb3d31602c0a9169a2a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Inflation adjusting with Realtalk'\n---\n\n\n\n\n**Note:** Users will need to install realtalk and epiextractr for this example. Refer to [EPI packages for R](epi_libraries.qmd) for installation instructions.\n\n## Loading CPI Indices using the [realtalk](https://economic.github.io/realtalk/) library\n\nThe following chunk of code loads the R libraries necessary for this exercise. You may need to install them to run this code.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Load necessary libraries\nlibrary(tidyverse)\nlibrary(realtalk)\nlibrary(epiextractr)\nlibrary(here)\n```\n:::\n\n\n\n\nThe RealTalk package includes several datasets of common US price indices. You may view those by executing the available_price_indexes() command.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#list available cpi series\nrealtalk::available_price_indexes\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 20 × 6\n   index_name        frequency seasonal min_date max_date package_data_name     \n   <chr>             <chr>     <chr>    <chr>    <chr>    <chr>                 \n 1 C-CPI-U           annual    <NA>     2000     2023     c_cpi_u_annual        \n 2 C-CPI-U           monthly   NSA      Dec 1999 Nov 2024 c_cpi_u_monthly_nsa   \n 3 C-CPI-U           quarterly NSA      2000q1   2024q3   c_cpi_u_quarterly_nsa \n 4 C-CPI-U, extended annual    <NA>     1937     2023     c_cpi_u_extended_annu…\n 5 C-CPI-U, extended monthly   NSA      Jan 1937 Nov 2024 c_cpi_u_extended_mont…\n 6 C-CPI-U, extended monthly   SA       Jan 1947 Nov 2024 c_cpi_u_extended_mont…\n 7 C-CPI-U, extended quarterly NSA      1937q1   2024q3   c_cpi_u_extended_quar…\n 8 C-CPI-U, extended quarterly SA       1947q1   2024q3   c_cpi_u_extended_quar…\n 9 CPI-U             annual    <NA>     1937     2023     cpi_u_annual          \n10 CPI-U             monthly   NSA      Jan 1937 Nov 2024 cpi_u_monthly_nsa     \n11 CPI-U             monthly   SA       Jan 1947 Nov 2024 cpi_u_monthly_sa      \n12 CPI-U             quarterly NSA      1937q1   2024q3   cpi_u_quarterly_nsa   \n13 CPI-U             quarterly SA       1947q1   2024q3   cpi_u_quarterly_sa    \n14 CPI-U-RS          annual    <NA>     1978     2023     cpi_u_rs_annual       \n15 CPI-U-RS          monthly   NSA      Dec 1977 Dec 2023 cpi_u_rs_monthly_nsa  \n16 CPI-U-X1          annual    <NA>     1967     1982     cpi_u_x1_annual       \n17 CPI-U-X1          monthly   NSA      Jan 1967 Dec 1982 cpi_u_x1_monthly_nsa  \n18 PCE               annual    <NA>     1929     2023     pce_annual            \n19 PCE               monthly   SA       Jan 1959 Oct 2024 pce_monthly_sa        \n20 PCE               quarterly SA       1947q1   2024q3   pce_quarterly_sa      \n```\n\n\n:::\n:::\n\n\n\n\nEPI uses the CPI-U-RS series to inflation adjust wages, so we'll select that series and assign it to a dataframe.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#this creates a dataframe with the annual CPI-U-RS index from 1937-2022\ncpi_data <- realtalk::cpi_u_rs_annual\n\n#Set base year to 2022\ncpi2022 <- cpi_data$cpi_u_rs[cpi_data$year==2022]\n```\n:::\n\n\n\n\n## A refresher on inflation adjustment\n\nBefore jumping into the full code. Let's refresh on how to calculate inflation using the Consumer Price Index.\n\nInflation in a given year is calculated by dividing the price of a market basket in a particular year by the price of the same basket in the base year, like so:\n\n$$\n\\frac{\\text{Given year}}{\\text{Base year}} * 100\n$$\n\nFor example, let's calculate how much the CPI-U-RS index has increased from 1978 to 2022.\n\n$$\n\\frac{\\text{CPI}_{2022}}{\\text{CPI}_{1978}} = \\frac{431.5}{104} \\approx 4.149038 \\text{ or } 414.9\\%\n$$\n\nAnd voila - we see that inflation has caused the basket of goods to increase 414.9% since 1978.\n\n## Applying inflation adjustment to CPS ORG wage data\n\nThis section uses [epiextractr](https://economic.github.io/epiextractr) to load Current Population Survey data. Refer to the [Using EPI's CPS Extracts](epi_microdata.qmd) to learn how to use this library.\n\nBelow, I load CPS ORG data and define my sample:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\norg <- load_org(2012:2022, year, month, orgwgt, wage, age, lfstat) %>% \n    #define sample universe\n    filter(age>=16, lfstat %in% c(1,2))\n```\n:::\n\n\n\n\nNext, calculate median wages in the CPS. and merge the annual CPI index to the dataframe using left_join()\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Calculate median wages in the CPS ORG\nwage_data <- org %>% \n  #use MetricsWeighted package to calculate a weighted median\n  #Note: I am pooling 12 months of CPS data, \n  #so I adjust orgwgt—the survey weight— variable, dividing it by 12.\n  summarize(nominal_median_wage = \n               MetricsWeighted::weighted_median(wage, w=orgwgt/12, na.rm=TRUE),\n            .by=year) %>% \n\n#Merge annual CPI data to dataframe by year.\n  left_join(cpi_data, by='year') \n\nwage_data\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 11 × 3\n    year nominal_median_wage cpi_u_rs\n   <dbl>               <dbl>    <dbl>\n 1  2012                16       337.\n 2  2013                16.4     342 \n 3  2014                16.8     348.\n 4  2015                17       348.\n 5  2016                17.5     353.\n 6  2017                18       360.\n 7  2018                18.8     369.\n 8  2019                19.2     376.\n 9  2020                21       381.\n10  2021                21.4     399.\n11  2022                22.9     432.\n```\n\n\n:::\n:::\n\n\n\n\nFinally, calculate the inflation rate relative to 2022, and the inflation adjusted median wage using the CPI index as follows:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nadjusted_data <- wage_data %>% \n \n  #This mutate command calculates inflation in a given year, relative to 2022\n  #and multiplies nominal median wages by the inflation quotient\n  mutate(infl_rel_to_2022 = signif(x = ((cpi2022/cpi_u_rs)-1), digits=2),\n         real_wage_2022 = nominal_median_wage*(cpi2022/cpi_u_rs)) %>% \n  \n  relocate(infl_rel_to_2022, nominal_median_wage, .after=cpi_u_rs)\n  \nadjusted_data\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 11 × 5\n    year cpi_u_rs infl_rel_to_2022 nominal_median_wage real_wage_2022\n   <dbl>    <dbl>            <dbl>               <dbl>          <dbl>\n 1  2012     337.            0.28                 16             20.5\n 2  2013     342             0.26                 16.4           20.7\n 3  2014     348.            0.24                 16.8           20.8\n 4  2015     348.            0.24                 17             21.1\n 5  2016     353.            0.22                 17.5           21.4\n 6  2017     360.            0.2                  18             21.6\n 7  2018     369.            0.17                 18.8           21.9\n 8  2019     376.            0.15                 19.2           22.1\n 9  2020     381.            0.13                 21             23.8\n10  2021     399.            0.081                21.4           23.1\n11  2022     432.            0                    22.9           22.9\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}